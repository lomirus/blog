# RSA加密算法原理所涉及的数学基础

初始创建于：***2020/12/15***

最后编辑于：***2020/12/16***

## 互质

### 定义

如果两个或两个以上的整数的最大公约数是 1，则称它们为互质（又名“互素”）。

### 实例

* “1, 2”的最大公约数是 1，所以“1, 2”互质；
* “2, 3”的最大公约数是 1，所以“2, 3”互质；
* “2, 4”的最大公约数是 2，所以“2, 4”不互质；
* “3, 4, 5”的最大公约数是 1，所以“3, 4, 5”互质。

（对于1与1是否互质这个问题，网上说法不一，此处不做讨论）

## 欧拉函数

### 定义

现定义函数
``$$\phi(n)`` ，其返回值为小于或等于 n 的正整数中与互质的数的数目。

### 实例

```math
\phi(2)=1 (1) \\
\phi(3)=2 (1,2) \\
\phi(4)=2 (1,3) \\
\phi(5)=4 (1,2,3,4) \\
\phi(6)=2 (1,5) \\
\phi(7)=6 (1,2,3,4,5,6) \\
\phi(8)=4 (1,3,5,7) \\
```

### 特性

1. 显然，若 ``$$p`` 为质数，则所有小于 ``$$p`` 的正整数均与 ``$$p`` 互质，只有 ``$$p`` 与其本身不互质  ``$$(p\neq1)`` 。
   观察上述实例不难发现，对于函数 ``$$\phi(p)`` ，若 ``$$p`` 为质数，则 ``$$\phi(p)=p-1`` 。
2. 若``$$p_1``与``$$p_2``互质，则
```math
\phi(p_1\cdot p_2)=\phi(p_1)\cdot\phi(p_2)
```
	证明略~~（其实主要是因为我不会😅）~~。貌似要用到中国剩余定理什么的，感觉太麻烦，毕竟这篇文章的重点也不是专门搞数学研究的...有兴趣的同学可自行谷歌。
3. (1) (2) 联立，易知，若 ``$$p_1`` 与 ``$$p_2`` 互质，设
```math
N=p_1\cdot p_2
```
则有
```math
\phi(N)=(p_1-1)\cdot(p_2-1)
```
4. (3) 结论可推广至
```math
p_1,p_2,p_3\cdots p_n
```

### 例题

如果我们已知
``$$p_1,p_2,p_3\cdots p_n``
，那么想求
``$$\phi(N)``
就很简单了，例如，试求：
``$$\phi(77)``

显然：
```math
\phi(77)\\
=\phi(7*11)\\
=\phi(7)\cdot\phi(7)(1)\\
=(7-1)*(11-1)\\
=6*10\\
=60
```

## 同余

### 定义

对于两个整数 ``$$a, b`` ，若它们除以正整数 ``$$m`` 所得的余数相等，则称 ``$$a, b`` 对于模 ``$$m`` 同余，记作 
```math
a\equiv b\quad(mod\quad a)
```

### 实例

```math
26\equiv 14\quad(mod\quad 12) \\
3^4\equiv 1\quad(mod\quad 5)
```

## 欧拉定理

### 定义

数学形式：若正整数``$$a,n`` 互质，则有
```math
a^{\phi(n)}\equiv 1\quad(mod\quad n)
```

伪代码形式：

```js
a ** euler(n) % n == 1 // true
```

为排版简洁，下文将简称 “欧拉定理” 为 “``$$ET``” （Euler's Theorem）。
### 实例

```math
3^{\phi(5)}\equiv 1\quad(mod\quad 5)
```
其中 
```math
\phi(5)= 4
```

### 推论

因为
```math
a^{\phi(n)}\equiv 1\quad(mod\quad n)
```
即
```math
a^{\phi(n)}\%n=1
```
所以
```math
(a^{\phi(n)}-1)\%n=0
```
所以
```math
\{[a^{\phi(n)}-1]\cdot a^{\phi(n)}\}\%n=0
```
记上式为 ``$$I.`` 式，则有
```math
\{[{a^{\phi(n)}}]^2\}\%n\\
=[a^{\phi(n)}\cdot a^{\phi(n)}]\%n\\
=\{[a^{\phi(n)}-1+1]\cdot a^{\phi(n)}]\}\%n\\
=\{[a^{\phi(n)}-1]\cdot a^{\phi(n)}+a^{\phi(n)}\}\%n\\
\stackrel{I.}{=\!=}a^{\phi(n)}\%n\\
\stackrel{ET}{=\!=}1
```
推而广之，我们有
```math
[a^{k\cdot \phi(n)} ]\%n\\
=\{[a^{\phi(n)}]^k\}\%n\\
=a^{\phi(n)}\%n\\
\stackrel{ET}{=\!=}1(k\in N^*)
```
所以
```math
\{[a^{k\cdot \phi(n)}-1]\cdot a\}\%n=0(k\in N^*)
```
记上式为 ``$$II.`` 式，则有
```math
[a^{k\cdot \phi(n)+1} ]\%n\\
=[a^{k\cdot \phi(n)}\cdot a]\%n\\
=\{[a^{k\cdot \phi(n)}-1+1]\cdot a\}\%n\\
=\{[a^{k\cdot \phi(n)}-1]\cdot a+a\}\%n\\
\stackrel{II.}{=\!=}a\%n
```
即
```math
a^{k\cdot \phi(n)+1}\equiv a\quad(mod\quad n)
```

## 模逆元

### 定义

若整数 ```$$a,b``` 满足 
```math
ab\equiv1\quad(mod\quad n)
```
则 ```$$a,b``` 互为对 ```$$n``` 模逆元。

### 特性

显然，若 ```$$b``` 为 ```$$a``` 的模逆元，则 ```$$b+kn``` 均为 ```$$a``` 的模逆元。

### 计算

欧拉定理对于模逆元必定存在的证明：
```math
a^{\phi(n)}=a\cdot a^{\phi(n)-1}\equiv1\quad(mod\quad n)
```
显然， ``$$a`` 的模逆元（之一）即为
```math
a^{\phi(n)-1}
```





